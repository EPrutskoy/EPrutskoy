# Определение возраста покупателей

**1. Размер выборки:**
- Общее количество образцов: 7591

**2. График распределения возраста:**
- Гистограмма с наложенной линией плотности показывает,\
что большинство образцов в наборе данных сосредоточены в диапазоне от 0 до 40 лет. \
Пик приходится на возрастную группу около 25-30 лет, после чего наблюдается постепенное снижение числа образцов с увеличением возраста. \
Этот график указывает на возможный дисбаланс в данных, так как возрастные группы старше 50 лет представлены значительно меньше.

**3. Пример фотографий из набора данных:**
- На изображениях видно разнообразие в возрасте, расе и поле. \
Также присутствует различие в условиях освещения, позах и выражениях лиц,\
что говорит о высоком уровне разнообразия в наборе данных.\
Однако, важно отметить, что все изображения не идеально выровнены, и на некоторых есть повороты.

**4. Дисбаланс в возрастных группах:** 
- Большая часть данных сосредоточена в молодом и среднем возрасте (до 40 лет).\
Недостаточное представление старших возрастных групп может привести к тому,\
что модель будет плохо обобщать на этой возрастной группе.\
Для борьбы с этим можно рассмотреть применение техники аугментации данных или использование взвешенных потерь,\
чтобы уделить больше внимания менее представленным группам.

**5. Разнообразие данных:** 
- Набор данных включает изображения с различными характеристиками, \
что является положительным фактором для обучения модели.\
Это помогает модели быть более устойчивой к изменениям условий съёмки, таким как освещение и поза.

**6. Неравномерность изображений:**
- Некоторое количество изображений не выровнено должным образом,\
что может вызвать дополнительные трудности при обучении модели.\
Возможно, следует рассмотреть предварительную обработку изображений для выравнивания лиц.

Эти выводы можно использовать для улучшения модели, включая пересмотр стратегии аугментации данных, использование более сложных архитектур для обработки разнообразных данных и дополнительную обработку изображений перед обучением модели.

## Анализ обученной модели

**1. Архитектура и настройки модели:**
- Модель основана на предобученной ResNet50 с весами `imagenet` и исключением верхних слоев (`include_top=False`).
- Дополнительно добавлены слои:
  - `Dropout` (с вероятностью 0.1) для регуляризации.
  - `GlobalAveragePooling2D` для сведения признаков к фиксированному размеру.
  - Полносвязный слой с одним нейроном и активацией `ReLU` для регрессии (предсказание возрастов).
- Оптимизатор `Adam` с начальной скоростью обучения 0.0001.
- Функция потерь: `mean_squared_error` (MSE).
- Метрика: `mean_absolute_error` (MAE).

**2. Результаты обучения:**
- **MAE на тренировочной выборке:** снижается с каждой эпохой, что указывает на успешное обучение модели. Начиная с 5.9797 (первоначально) и снижаясь до 2.7149 к 10-й эпохе.
- **MAE на валидационной выборке:** также снижается, хотя и с меньшей скоростью. Начинается с 8.5245 и падает до 6.0603 к 10-й эпохе. 

**3. Выводы:**
- Модель демонстрирует успешное снижение ошибки на тренировочных данных, что указывает на способность модели обучаться.
- Ошибка на валидационной выборке также снижается, но сохраняется на более высоком уровне по сравнению с тренировочной выборкой, что может свидетельствовать о переобучении или недостаточной сложности модели.
- Для дальнейшего улучшения точности можно рассмотреть дополнительную настройку гиперпараметров, расширение набора данных или использование других архитектур.